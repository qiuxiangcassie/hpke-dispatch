<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="hpke"><meta name="keywords" content="rust, rustlang, rust-lang, hpke"><title>hpke - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../dark.css" disabled><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><script defer src="../main.js"></script>
    <noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../hpke/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../hpke/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Crate hpke</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.9.0</li><li><a id="all-types" href="all.html">All Items</a></li></div></ul><section><div class="block"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></div></section><div id="sidebar-vars" data-name="hpke" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../hpke/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="22" height="22" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">hpke</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/hpke/lib.rs.html#1-202">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="hpke"><a href="#hpke">hpke</a></h2>
<p><strong>WARNING:</strong> This code has not been audited. Use at your own discretion.</p>
<p>This is a pure Rust implementation of the
<a href="https://datatracker.ietf.org/doc/rfc9180/">HPKE</a> hybrid encryption scheme (RFC 9180). The
purpose of hybrid encryption is to use allow someone to send secure messages to an entity whose
public key they know. Here’s an example of Alice and Bob, where Alice knows Bob’s public key:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="comment">// These types define the ciphersuite Alice and Bob will be using</span>
<span class="kw">type</span> <span class="ident">Kem</span> <span class="op">=</span> <span class="ident">X25519HkdfSha256</span>;
<span class="kw">type</span> <span class="ident">Aead</span> <span class="op">=</span> <span class="ident">ChaCha20Poly1305</span>;
<span class="kw">type</span> <span class="ident">Kdf</span> <span class="op">=</span> <span class="ident">HkdfSha384</span>;

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">csprng</span> <span class="op">=</span> <span class="ident">StdRng::from_entropy</span>();

<span class="comment">// This is a description string for the session. Both Alice and Bob need to know this value.</span>
<span class="comment">// It&#39;s not secret.</span>
<span class="kw">let</span> <span class="ident">info_str</span> <span class="op">=</span> <span class="string">b&quot;Alice and Bob&#39;s weekly chat&quot;</span>;

<span class="comment">// Alice initiates a session with Bob. OpModeS::Base means that Alice is not authenticating</span>
<span class="comment">// herself at all. If she had a public key herself, or a pre-shared secret that Bob also</span>
<span class="comment">// knew, she&#39;d be able to authenticate herself. See the OpModeS and OpModeR types for more</span>
<span class="comment">// detail.</span>
<span class="kw">let</span> (<span class="ident">encapsulated_key</span>, <span class="kw-2">mut</span> <span class="ident">encryption_context</span>) <span class="op">=</span>
    <span class="ident">hpke::setup_sender</span>::<span class="op">&lt;</span><span class="ident">Aead</span>, <span class="ident">Kdf</span>, <span class="ident">Kem</span>, <span class="kw">_</span><span class="op">&gt;</span>(<span class="kw-2">&amp;</span><span class="ident">OpModeS::Base</span>, <span class="kw-2">&amp;</span><span class="ident">bob_pk</span>, <span class="ident">info_str</span>, <span class="kw-2">&amp;mut</span> <span class="ident">csprng</span>)
        .<span class="ident">expect</span>(<span class="string">&quot;invalid server pubkey!&quot;</span>);

<span class="comment">// Alice encrypts a message to Bob. `aad` is authenticated associated data that is not</span>
<span class="comment">// encrypted.</span>
<span class="kw">let</span> <span class="ident">msg</span> <span class="op">=</span> <span class="string">b&quot;fronthand or backhand?&quot;</span>;
<span class="kw">let</span> <span class="ident">aad</span> <span class="op">=</span> <span class="string">b&quot;a gentleman&#39;s game&quot;</span>;
<span class="comment">// To seal without allocating:</span>
<span class="comment">//     let auth_tag = encryption_context.seal_in_place_detached(&amp;mut msg, aad)?;</span>
<span class="comment">// To seal with allocating:</span>
<span class="kw">let</span> <span class="ident">ciphertext</span> <span class="op">=</span> <span class="ident">encryption_context</span>.<span class="ident">seal</span>(<span class="ident">msg</span>, <span class="ident">aad</span>).<span class="ident">expect</span>(<span class="string">&quot;encryption failed!&quot;</span>);

<span class="comment">// ~~~</span>
<span class="comment">// Alice sends the encapsulated key, message ciphertext, AAD, and auth tag to Bob over the</span>
<span class="comment">// internet. Alice doesn&#39;t care if it&#39;s an insecure connection, because only Bob can read</span>
<span class="comment">// her ciphertext.</span>
<span class="comment">// ~~~</span>

<span class="comment">// Somewhere far away, Bob receives the data and makes a decryption session</span>
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">decryption_context</span> <span class="op">=</span>
    <span class="ident">hpke::setup_receiver</span>::<span class="op">&lt;</span><span class="ident">Aead</span>, <span class="ident">Kdf</span>, <span class="ident">Kem</span><span class="op">&gt;</span>(
        <span class="kw-2">&amp;</span><span class="ident">OpModeR::Base</span>,
        <span class="kw-2">&amp;</span><span class="ident">bob_sk</span>,
        <span class="kw-2">&amp;</span><span class="ident">encapsulated_key</span>,
        <span class="ident">info_str</span>,
    ).<span class="ident">expect</span>(<span class="string">&quot;failed to set up receiver!&quot;</span>);
<span class="comment">// To open without allocating:</span>
<span class="comment">//     decryption_context.open_in_place_detached(&amp;mut ciphertext, aad, &amp;auth_tag)</span>
<span class="comment">// To open with allocating:</span>
<span class="kw">let</span> <span class="ident">plaintext</span> <span class="op">=</span> <span class="ident">decryption_context</span>.<span class="ident">open</span>(<span class="kw-2">&amp;</span><span class="ident">ciphertext</span>, <span class="ident">aad</span>).<span class="ident">expect</span>(<span class="string">&quot;invalid ciphertext!&quot;</span>);

<span class="macro">assert_eq!</span>(<span class="kw-2">&amp;</span><span class="ident">plaintext</span>, <span class="string">b&quot;fronthand or backhand?&quot;</span>);</code></pre></div>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left import-item"><code>pub use <a class="mod" href="../generic_array/index.html" title="mod generic_array">generic_array</a>;</code></div><div class="item-right docblock-short"></div></div><div class="item-row"><div class="item-left import-item"><code>pub use <a class="mod" href="../rand_core/index.html" title="mod rand_core">rand_core</a>;</code></div><div class="item-right docblock-short"></div></div></div><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="aead/index.html" title="hpke::aead mod">aead</a></div><div class="item-right docblock-short"><p>Traits and structs for authenticated encryption schemes</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="kdf/index.html" title="hpke::kdf mod">kdf</a></div><div class="item-right docblock-short"><p>Traits and structs for key derivation functions</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="kem/index.html" title="hpke::kem mod">kem</a></div><div class="item-right docblock-short"><p>Traits and structs for key encapsulation mechanisms</p>
</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PskBundle.html" title="hpke::PskBundle struct">PskBundle</a></div><div class="item-right docblock-short"><p>Contains preshared key bytes and an identifier. This is intended to go inside an <code>OpModeR</code> or
<code>OpModeS</code> struct.</p>
</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.HpkeError.html" title="hpke::HpkeError enum">HpkeError</a></div><div class="item-right docblock-short"><p>Describes things that can go wrong in the HPKE protocol</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.OpModeR.html" title="hpke::OpModeR enum">OpModeR</a></div><div class="item-right docblock-short"><p>The operation mode of the HPKE session (receiver’s view). This is how the sender authenticates
their identity to the receiver. This authentication information can include a preshared key,
the identity key of the sender, both, or neither. <code>Base</code> is the only mode that does not provide
any kind of sender identity authentication.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.OpModeS.html" title="hpke::OpModeS enum">OpModeS</a></div><div class="item-right docblock-short"><p>The operation mode of the HPKE session (sender’s view). This is how the sender authenticates
their identity to the receiver. This authentication information can include a preshared key,
the identity key of the sender, both, or neither. <code>Base</code> is the only mode that does not provide
any kind of sender identity authentication.</p>
</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Deserializable.html" title="hpke::Deserializable trait">Deserializable</a></div><div class="item-right docblock-short"><p>Implemented by types that can be deserialized from byte representation</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Kem.html" title="hpke::Kem trait">Kem</a></div><div class="item-right docblock-short"><p>Represents authenticated encryption functionality</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Serializable.html" title="hpke::Serializable trait">Serializable</a></div><div class="item-right docblock-short"><p>Implemented by types that have a fixed-length byte representation</p>
</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.setup_receiver.html" title="hpke::setup_receiver fn">setup_receiver</a></div><div class="item-right docblock-short"><p>Initiates a decryption context given a private key <code>sk_recip</code> and an encapsulated key which
was encapsulated to <code>sk_recip</code>’s corresponding public key</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.setup_sender.html" title="hpke::setup_sender fn">setup_sender</a></div><div class="item-right docblock-short"><p>Initiates an encryption context to the given recipient public key</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.single_shot_open.html" title="hpke::single_shot_open fn">single_shot_open</a></div><div class="item-right docblock-short"><p>Does a <code>setup_receiver</code> and <code>AeadCtxR::open</code> in one shot. That is, it does a key decapsulation
for the specified recipient and decrypts the provided ciphertext. See <code>setup::setup_reciever</code>
and <code>AeadCtxR::open</code> for more detail.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.single_shot_open_in_place_detached.html" title="hpke::single_shot_open_in_place_detached fn">single_shot_open_in_place_detached</a></div><div class="item-right docblock-short"><p>Does a <code>setup_receiver</code> and <code>AeadCtxR::open_in_place_detached</code> in one shot. That is, it does a
key decapsulation for the specified recipient and decrypts the provided ciphertext in place.
See <code>setup::setup_reciever</code> and <code>AeadCtxR::open_in_place_detached</code> for more detail.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.single_shot_seal.html" title="hpke::single_shot_seal fn">single_shot_seal</a></div><div class="item-right docblock-short"><p>Does a <code>setup_sender</code> and <code>AeadCtxS::seal</code> in one shot. That is, it does a key encapsulation to
the specified recipient and encrypts the provided plaintext. See <code>setup::setup_sender</code> and
<code>AeadCtxS::seal</code> for more detail.</p>
</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.single_shot_seal_in_place_detached.html" title="hpke::single_shot_seal_in_place_detached fn">single_shot_seal_in_place_detached</a></div><div class="item-right docblock-short"><p>Does a <code>setup_sender</code> and <code>AeadCtxS::seal_in_place_detached</code> in one shot. That is, it does a
key encapsulation to the specified recipient and encrypts the provided plaintext in place. See
<code>setup::setup_sender</code> and <code>AeadCtxS::seal_in_place_detached</code> for more detail.</p>
</div></div></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="hpke" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.61.0 (fe5b13d68 2022-05-18)" ></div>
</body></html>